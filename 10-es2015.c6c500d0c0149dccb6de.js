(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{TDBs:function(t,e,n){"use strict";n.r(e),n.d(e,"DashboardPageModule",(function(){return _t}));var o,r=n("ofXK"),i=n("3Pt+"),s=n("TEn/"),a=n("tyNb"),c=n("qb46"),l=n.n(c),u=n("BEOd"),h=(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),p=function(t){function e(e,n){var o=this,r=this.constructor.prototype;return(o=t.call(this,e)||this).statusCode=n,o.__proto__=r,o}return h(e,t),e}(Error),f=function(t){function e(e){void 0===e&&(e="A timeout occurred.");var n=this,o=this.constructor.prototype;return(n=t.call(this,e)||this).__proto__=o,n}return h(e,t),e}(Error),d=function(t){function e(e){void 0===e&&(e="An abort occurred.");var n=this,o=this.constructor.prototype;return(n=t.call(this,e)||this).__proto__=o,n}return h(e,t),e}(Error),g=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},b=function(){return function(t,e,n){this.statusCode=t,this.statusText=e,this.content=n}}(),v=function(){function t(){}return t.prototype.get=function(t,e){return this.send(g({},e,{method:"GET",url:t}))},t.prototype.post=function(t,e){return this.send(g({},e,{method:"POST",url:t}))},t.prototype.delete=function(t,e){return this.send(g({},e,{method:"DELETE",url:t}))},t.prototype.getCookieString=function(t){return""},t}(),y=function(t){return t[t.Trace=0]="Trace",t[t.Debug=1]="Debug",t[t.Information=2]="Information",t[t.Warning=3]="Warning",t[t.Error=4]="Error",t[t.Critical=5]="Critical",t[t.None=6]="None",t}({}),m=function(){function t(){}return t.prototype.log=function(t,e){},t.instance=new t,t}(),w=function(){function t(){}return t.isRequired=function(t,e){if(null==t)throw new Error("The '"+e+"' argument is required.")},t.isIn=function(t,e,n){if(!(t in e))throw new Error("Unknown "+n+" value: "+t+".")},t}();function x(t,e){var n="";return S(t)?(n="Binary data of length "+t.byteLength,e&&(n+=". Content: '"+function(t){var e=new Uint8Array(t),n="";return e.forEach((function(t){n+="0x"+(t<16?"0":"")+t.toString(16)+" "})),n.substr(0,n.length-1)}(t)+"'")):"string"==typeof t&&(n="String data of length "+t.length,e&&(n+=". Content: '"+t+"'")),n}function S(t){return t&&"undefined"!=typeof ArrayBuffer&&(t instanceof ArrayBuffer||t.constructor&&"ArrayBuffer"===t.constructor.name)}function k(t,e,n,o,r,i,s){return a=this,void 0,l=function(){var a,c,l,u,h;return function(t,e){var n,o,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,o=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!((r=(r=s.trys).length>0&&r[r.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){s.label=i[1];break}if(6===i[0]&&s.label<r[1]){s.label=r[1],r=i;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(i);break}r[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(a){i=[6,a],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}}(this,(function(p){switch(p.label){case 0:return r?[4,r()]:[3,2];case 1:(l=p.sent())&&((a={}).Authorization="Bearer "+l,c=a),p.label=2;case 2:return t.log(y.Trace,"("+e+" transport) sending data. "+x(i,s)+"."),u=S(i)?"arraybuffer":"text",[4,n.post(o,{content:i,headers:c,responseType:u})];case 3:return h=p.sent(),t.log(y.Trace,"("+e+" transport) request complete. Response status: "+h.statusCode+"."),[2]}}))},new((c=void 0)||(c=Promise))((function(t,e){function n(t){try{r(l.next(t))}catch(n){e(n)}}function o(t){try{r(l.throw(t))}catch(n){e(n)}}function r(e){e.done?t(e.value):new c((function(t){t(e.value)})).then(n,o)}r((l=l.apply(a,[])).next())}));var a,c,l}var P,C=function(){function t(){this.observers=[]}return t.prototype.next=function(t){for(var e=0,n=this.observers;e<n.length;e++)n[e].next(t)},t.prototype.error=function(t){for(var e=0,n=this.observers;e<n.length;e++){var o=n[e];o.error&&o.error(t)}},t.prototype.complete=function(){for(var t=0,e=this.observers;t<e.length;t++){var n=e[t];n.complete&&n.complete()}},t.prototype.subscribe=function(t){return this.observers.push(t),new _(this,t)},t}(),_=function(){function t(t,e){this.subject=t,this.observer=e}return t.prototype.dispose=function(){var t=this.subject.observers.indexOf(this.observer);t>-1&&this.subject.observers.splice(t,1),0===this.subject.observers.length&&this.subject.cancelCallback&&this.subject.cancelCallback().catch((function(t){}))},t}(),O=function(){function t(t){this.minimumLogLevel=t}return t.prototype.log=function(t,e){if(t>=this.minimumLogLevel)switch(t){case y.Critical:case y.Error:console.error("["+(new Date).toISOString()+"] "+y[t]+": "+e);break;case y.Warning:console.warn("["+(new Date).toISOString()+"] "+y[t]+": "+e);break;case y.Information:console.info("["+(new Date).toISOString()+"] "+y[t]+": "+e);break;default:console.log("["+(new Date).toISOString()+"] "+y[t]+": "+e)}},t}(),T=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),E=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t};if("undefined"==typeof XMLHttpRequest){var I=require;P=I("request")}var M=function(t){function e(e){var n=t.call(this)||this;if(void 0===P)throw new Error("The 'request' module could not be loaded.");return n.logger=e,n.cookieJar=P.jar(),n.request=P.defaults({jar:n.cookieJar}),n}return T(e,t),e.prototype.send=function(t){var e=this;return new Promise((function(n,o){var r;r=S(t.content)?Buffer.from(t.content):t.content||"";var i=e.request(t.url,{body:r,encoding:"arraybuffer"===t.responseType?null:"utf8",headers:E({"X-Requested-With":"XMLHttpRequest"},t.headers),method:t.method,timeout:t.timeout},(function(r,i,s){if(t.abortSignal&&(t.abortSignal.onabort=null),r)return"ETIMEDOUT"===r.code&&(e.logger.log(y.Warning,"Timeout from HTTP request."),o(new f)),e.logger.log(y.Warning,"Error from HTTP request. "+r),void o(r);i.statusCode>=200&&i.statusCode<300?n(new b(i.statusCode,i.statusMessage||"",s)):o(new p(i.statusMessage||"",i.statusCode||0))}));t.abortSignal&&(t.abortSignal.onabort=function(){i.abort(),o(new d)})}))},e.prototype.getCookieString=function(t){return this.cookieJar.getCookieString(t)},e}(v),R=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),A=function(t){function e(e){var n=t.call(this)||this;return n.logger=e,n}return R(e,t),e.prototype.send=function(t){var e=this;return t.abortSignal&&t.abortSignal.aborted?Promise.reject(new d):t.method?t.url?new Promise((function(n,o){var r=new XMLHttpRequest;r.open(t.method,t.url,!0),r.withCredentials=!0,r.setRequestHeader("X-Requested-With","XMLHttpRequest"),r.setRequestHeader("Content-Type","text/plain;charset=UTF-8");var i=t.headers;i&&Object.keys(i).forEach((function(t){r.setRequestHeader(t,i[t])})),t.responseType&&(r.responseType=t.responseType),t.abortSignal&&(t.abortSignal.onabort=function(){r.abort(),o(new d)}),t.timeout&&(r.timeout=t.timeout),r.onload=function(){t.abortSignal&&(t.abortSignal.onabort=null),r.status>=200&&r.status<300?n(new b(r.status,r.statusText,r.response||r.responseText)):o(new p(r.statusText,r.status))},r.onerror=function(){e.logger.log(y.Warning,"Error from HTTP request. "+r.status+": "+r.statusText+"."),o(new p(r.statusText,r.status))},r.ontimeout=function(){e.logger.log(y.Warning,"Timeout from HTTP request."),o(new f)},r.send(t.content||"")})):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))},e}(v),z=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),j=function(t){function e(e){var n=t.call(this)||this;return n.httpClient="undefined"!=typeof XMLHttpRequest?new A(e):new M(e),n}return z(e,t),e.prototype.send=function(t){return t.abortSignal&&t.abortSignal.aborted?Promise.reject(new d):t.method?t.url?this.httpClient.send(t):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))},e.prototype.getCookieString=function(t){return this.httpClient.getCookieString(t)},e}(v),F=function(){function t(){}return t.write=function(e){return""+e+t.RecordSeparator},t.parse=function(e){if(e[e.length-1]!==t.RecordSeparator)throw new Error("Message is incomplete.");var n=e.split(t.RecordSeparator);return n.pop(),n},t.RecordSeparatorCode=30,t.RecordSeparator=String.fromCharCode(t.RecordSeparatorCode),t}(),q=function(){function t(){}return t.prototype.writeHandshakeRequest=function(t){return F.write(JSON.stringify(t))},t.prototype.parseHandshakeResponse=function(t){var e,n;if(S(t)||"undefined"!=typeof Buffer&&t instanceof Buffer){var o=new Uint8Array(t);if(-1===(i=o.indexOf(F.RecordSeparatorCode)))throw new Error("Message is incomplete.");var r=i+1;e=String.fromCharCode.apply(null,o.slice(0,r)),n=o.byteLength>r?o.slice(r).buffer:null}else{var i,s=t;if(-1===(i=s.indexOf(F.RecordSeparator)))throw new Error("Message is incomplete.");e=s.substring(0,r=i+1),n=s.length>r?s.substring(r):null}var a=F.parse(e),c=JSON.parse(a[0]);if(c.type)throw new Error("Expected a handshake response from the server.");return[n,c]},t}(),D=function(t){return t[t.Invocation=1]="Invocation",t[t.StreamItem=2]="StreamItem",t[t.Completion=3]="Completion",t[t.StreamInvocation=4]="StreamInvocation",t[t.CancelInvocation=5]="CancelInvocation",t[t.Ping=6]="Ping",t[t.Close=7]="Close",t}({}),N=function(t,e,n,o){return new(n||(n=Promise))((function(r,i){function s(t){try{c(o.next(t))}catch(e){i(e)}}function a(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){t.done?r(t.value):new n((function(e){e(t.value)})).then(s,a)}c((o=o.apply(t,e||[])).next())}))},W=function(t,e){var n,o,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,o=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!((r=(r=s.trys).length>0&&r[r.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){s.label=i[1];break}if(6===i[0]&&s.label<r[1]){s.label=r[1],r=i;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(i);break}r[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(a){i=[6,a],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},H=function(t){return t[t.Disconnected=0]="Disconnected",t[t.Connected=1]="Connected",t}({}),L=function(){function t(t,e,n){var o=this;w.isRequired(t,"connection"),w.isRequired(e,"logger"),w.isRequired(n,"protocol"),this.serverTimeoutInMilliseconds=3e4,this.keepAliveIntervalInMilliseconds=15e3,this.logger=e,this.protocol=n,this.connection=t,this.handshakeProtocol=new q,this.connection.onreceive=function(t){return o.processIncomingData(t)},this.connection.onclose=function(t){return o.connectionClosed(t)},this.callbacks={},this.methods={},this.closedCallbacks=[],this.id=0,this.receivedHandshakeResponse=!1,this.connectionState=H.Disconnected,this.cachedPingMessage=this.protocol.writeMessage({type:D.Ping})}return t.create=function(e,n,o){return new t(e,n,o)},Object.defineProperty(t.prototype,"state",{get:function(){return this.connectionState},enumerable:!0,configurable:!0}),t.prototype.start=function(){return N(this,void 0,void 0,(function(){var t,e,n=this;return W(this,(function(o){switch(o.label){case 0:return t={protocol:this.protocol.name,version:this.protocol.version},this.logger.log(y.Debug,"Starting HubConnection."),this.receivedHandshakeResponse=!1,e=new Promise((function(t,e){n.handshakeResolver=t,n.handshakeRejecter=e})),[4,this.connection.start(this.protocol.transferFormat)];case 1:return o.sent(),this.logger.log(y.Debug,"Sending handshake request."),[4,this.sendMessage(this.handshakeProtocol.writeHandshakeRequest(t))];case 2:return o.sent(),this.logger.log(y.Information,"Using HubProtocol '"+this.protocol.name+"'."),this.cleanupTimeout(),this.resetTimeoutPeriod(),this.resetKeepAliveInterval(),[4,e];case 3:return o.sent(),this.connectionState=H.Connected,[2]}}))}))},t.prototype.stop=function(){return this.logger.log(y.Debug,"Stopping HubConnection."),this.cleanupTimeout(),this.cleanupPingTimer(),this.connection.stop()},t.prototype.stream=function(t){for(var e=this,n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];var r,i=this.createStreamInvocation(t,n),s=new C;s.cancelCallback=function(){var t=e.createCancelInvocation(i.invocationId),n=e.protocol.writeMessage(t);return delete e.callbacks[i.invocationId],r.then((function(){return e.sendMessage(n)}))},this.callbacks[i.invocationId]=function(t,e){e?s.error(e):t&&(t.type===D.Completion?t.error?s.error(new Error(t.error)):s.complete():s.next(t.item))};var a=this.protocol.writeMessage(i);return r=this.sendMessage(a).catch((function(t){s.error(t),delete e.callbacks[i.invocationId]})),s},t.prototype.sendMessage=function(t){return this.resetKeepAliveInterval(),this.connection.send(t)},t.prototype.send=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var o=this.createInvocation(t,e,!0),r=this.protocol.writeMessage(o);return this.sendMessage(r)},t.prototype.invoke=function(t){for(var e=this,n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];var r=this.createInvocation(t,n,!1),i=new Promise((function(t,n){e.callbacks[r.invocationId]=function(e,o){o?n(o):e&&(e.type===D.Completion?e.error?n(new Error(e.error)):t(e.result):n(new Error("Unexpected message type: "+e.type)))};var o=e.protocol.writeMessage(r);e.sendMessage(o).catch((function(t){n(t),delete e.callbacks[r.invocationId]}))}));return i},t.prototype.on=function(t,e){t&&e&&(t=t.toLowerCase(),this.methods[t]||(this.methods[t]=[]),-1===this.methods[t].indexOf(e)&&this.methods[t].push(e))},t.prototype.off=function(t,e){if(t){t=t.toLowerCase();var n=this.methods[t];if(n)if(e){var o=n.indexOf(e);-1!==o&&(n.splice(o,1),0===n.length&&delete this.methods[t])}else delete this.methods[t]}},t.prototype.onclose=function(t){t&&this.closedCallbacks.push(t)},t.prototype.processIncomingData=function(t){if(this.cleanupTimeout(),this.receivedHandshakeResponse||(t=this.processHandshakeResponse(t),this.receivedHandshakeResponse=!0),t)for(var e=0,n=this.protocol.parseMessages(t,this.logger);e<n.length;e++){var o=n[e];switch(o.type){case D.Invocation:this.invokeClientMethod(o);break;case D.StreamItem:case D.Completion:var r=this.callbacks[o.invocationId];null!=r&&(o.type===D.Completion&&delete this.callbacks[o.invocationId],r(o));break;case D.Ping:break;case D.Close:this.logger.log(y.Information,"Close message received from server."),this.connection.stop(o.error?new Error("Server returned an error on close: "+o.error):void 0);break;default:this.logger.log(y.Warning,"Invalid message type: "+o.type+".")}}this.resetTimeoutPeriod()},t.prototype.processHandshakeResponse=function(t){var e,n,o;try{o=(e=this.handshakeProtocol.parseHandshakeResponse(t))[0],n=e[1]}catch(s){var r;this.logger.log(y.Error,r="Error parsing handshake response: "+s);var i=new Error(r);throw this.connection.stop(i),this.handshakeRejecter(i),i}if(n.error)throw this.logger.log(y.Error,r="Server returned handshake error: "+n.error),this.handshakeRejecter(r),this.connection.stop(new Error(r)),new Error(r);return this.logger.log(y.Debug,"Server handshake complete."),this.handshakeResolver(),o},t.prototype.resetKeepAliveInterval=function(){var t=this;this.cleanupPingTimer(),this.pingServerHandle=setTimeout((function(){return N(t,void 0,void 0,(function(){return W(this,(function(t){switch(t.label){case 0:if(this.connectionState!==H.Connected)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.sendMessage(this.cachedPingMessage)];case 2:return t.sent(),[3,4];case 3:return t.sent(),this.cleanupPingTimer(),[3,4];case 4:return[2]}}))}))}),this.keepAliveIntervalInMilliseconds)},t.prototype.resetTimeoutPeriod=function(){var t=this;this.connection.features&&this.connection.features.inherentKeepAlive||(this.timeoutHandle=setTimeout((function(){return t.serverTimeout()}),this.serverTimeoutInMilliseconds))},t.prototype.serverTimeout=function(){this.connection.stop(new Error("Server timeout elapsed without receiving a message from the server."))},t.prototype.invokeClientMethod=function(t){var e=this,n=this.methods[t.target.toLowerCase()];if(n){if(n.forEach((function(n){return n.apply(e,t.arguments)})),t.invocationId){var o="Server requested a response, which is not supported in this version of the client.";this.logger.log(y.Error,o),this.connection.stop(new Error(o))}}else this.logger.log(y.Warning,"No client method with the name '"+t.target+"' found.")},t.prototype.connectionClosed=function(t){var e=this,n=this.callbacks;this.callbacks={},this.connectionState=H.Disconnected,this.handshakeRejecter&&this.handshakeRejecter(t),Object.keys(n).forEach((function(e){(0,n[e])(null,t||new Error("Invocation canceled due to connection being closed."))})),this.cleanupTimeout(),this.cleanupPingTimer(),this.closedCallbacks.forEach((function(n){return n.apply(e,[t])}))},t.prototype.cleanupPingTimer=function(){this.pingServerHandle&&clearTimeout(this.pingServerHandle)},t.prototype.cleanupTimeout=function(){this.timeoutHandle&&clearTimeout(this.timeoutHandle)},t.prototype.createInvocation=function(t,e,n){if(n)return{arguments:e,target:t,type:D.Invocation};var o=this.id;return this.id++,{arguments:e,invocationId:o.toString(),target:t,type:D.Invocation}},t.prototype.createStreamInvocation=function(t,e){var n=this.id;return this.id++,{arguments:e,invocationId:n.toString(),target:t,type:D.StreamInvocation}},t.prototype.createCancelInvocation=function(t){return{invocationId:t,type:D.CancelInvocation}},t}(),B=function(t){return t[t.None=0]="None",t[t.WebSockets=1]="WebSockets",t[t.ServerSentEvents=2]="ServerSentEvents",t[t.LongPolling=4]="LongPolling",t}({}),U=function(t){return t[t.Text=1]="Text",t[t.Binary=2]="Binary",t}({}),$=function(){function t(){this.isAborted=!1,this.onabort=null}return t.prototype.abort=function(){this.isAborted||(this.isAborted=!0,this.onabort&&this.onabort())},Object.defineProperty(t.prototype,"signal",{get:function(){return this},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"aborted",{get:function(){return this.isAborted},enumerable:!0,configurable:!0}),t}(),X=function(t,e,n,o){return new(n||(n=Promise))((function(r,i){function s(t){try{c(o.next(t))}catch(e){i(e)}}function a(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){t.done?r(t.value):new n((function(e){e(t.value)})).then(s,a)}c((o=o.apply(t,e||[])).next())}))},J=function(t,e){var n,o,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,o=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!((r=(r=s.trys).length>0&&r[r.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){s.label=i[1];break}if(6===i[0]&&s.label<r[1]){s.label=r[1],r=i;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(i);break}r[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(a){i=[6,a],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},K=function(){function t(t,e,n,o){this.httpClient=t,this.accessTokenFactory=e,this.logger=n,this.pollAbort=new $,this.logMessageContent=o,this.running=!1,this.onreceive=null,this.onclose=null}return Object.defineProperty(t.prototype,"pollAborted",{get:function(){return this.pollAbort.aborted},enumerable:!0,configurable:!0}),t.prototype.connect=function(t,e){return X(this,void 0,void 0,(function(){var n,o,r,i;return J(this,(function(s){switch(s.label){case 0:if(w.isRequired(t,"url"),w.isRequired(e,"transferFormat"),w.isIn(e,U,"transferFormat"),this.url=t,this.logger.log(y.Trace,"(LongPolling transport) Connecting."),e===U.Binary&&"undefined"!=typeof XMLHttpRequest&&"string"!=typeof(new XMLHttpRequest).responseType)throw new Error("Binary protocols over XmlHttpRequest not implementing advanced features are not supported.");return n={abortSignal:this.pollAbort.signal,headers:{},timeout:1e5},e===U.Binary&&(n.responseType="arraybuffer"),[4,this.getAccessToken()];case 1:return o=s.sent(),this.updateHeaderToken(n,o),r=t+"&_="+Date.now(),this.logger.log(y.Trace,"(LongPolling transport) polling: "+r+"."),[4,this.httpClient.get(r,n)];case 2:return 200!==(i=s.sent()).statusCode?(this.logger.log(y.Error,"(LongPolling transport) Unexpected response code: "+i.statusCode+"."),this.closeError=new p(i.statusText||"",i.statusCode),this.running=!1):this.running=!0,this.receiving=this.poll(this.url,n),[2]}}))}))},t.prototype.getAccessToken=function(){return X(this,void 0,void 0,(function(){return J(this,(function(t){switch(t.label){case 0:return this.accessTokenFactory?[4,this.accessTokenFactory()]:[3,2];case 1:return[2,t.sent()];case 2:return[2,null]}}))}))},t.prototype.updateHeaderToken=function(t,e){t.headers||(t.headers={}),e?t.headers.Authorization="Bearer "+e:t.headers.Authorization&&delete t.headers.Authorization},t.prototype.poll=function(t,e){return X(this,void 0,void 0,(function(){var n,o,r,i;return J(this,(function(s){switch(s.label){case 0:s.trys.push([0,,8,9]),s.label=1;case 1:return this.running?[4,this.getAccessToken()]:[3,7];case 2:n=s.sent(),this.updateHeaderToken(e,n),s.label=3;case 3:return s.trys.push([3,5,,6]),o=t+"&_="+Date.now(),this.logger.log(y.Trace,"(LongPolling transport) polling: "+o+"."),[4,this.httpClient.get(o,e)];case 4:return 204===(r=s.sent()).statusCode?(this.logger.log(y.Information,"(LongPolling transport) Poll terminated by server."),this.running=!1):200!==r.statusCode?(this.logger.log(y.Error,"(LongPolling transport) Unexpected response code: "+r.statusCode+"."),this.closeError=new p(r.statusText||"",r.statusCode),this.running=!1):r.content?(this.logger.log(y.Trace,"(LongPolling transport) data received. "+x(r.content,this.logMessageContent)+"."),this.onreceive&&this.onreceive(r.content)):this.logger.log(y.Trace,"(LongPolling transport) Poll timed out, reissuing."),[3,6];case 5:return i=s.sent(),this.running?i instanceof f?this.logger.log(y.Trace,"(LongPolling transport) Poll timed out, reissuing."):(this.closeError=i,this.running=!1):this.logger.log(y.Trace,"(LongPolling transport) Poll errored after shutdown: "+i.message),[3,6];case 6:return[3,1];case 7:return[3,9];case 8:return this.logger.log(y.Trace,"(LongPolling transport) Polling complete."),this.pollAborted||this.raiseOnClose(),[7];case 9:return[2]}}))}))},t.prototype.send=function(t){return X(this,void 0,void 0,(function(){return J(this,(function(e){return this.running?[2,k(this.logger,"LongPolling",this.httpClient,this.url,this.accessTokenFactory,t,this.logMessageContent)]:[2,Promise.reject(new Error("Cannot send until the transport is connected"))]}))}))},t.prototype.stop=function(){return X(this,void 0,void 0,(function(){var t,e;return J(this,(function(n){switch(n.label){case 0:this.logger.log(y.Trace,"(LongPolling transport) Stopping polling."),this.running=!1,this.pollAbort.abort(),n.label=1;case 1:return n.trys.push([1,,5,6]),[4,this.receiving];case 2:return n.sent(),this.logger.log(y.Trace,"(LongPolling transport) sending DELETE request to "+this.url+"."),t={headers:{}},[4,this.getAccessToken()];case 3:return e=n.sent(),this.updateHeaderToken(t,e),[4,this.httpClient.delete(this.url,t)];case 4:return n.sent(),this.logger.log(y.Trace,"(LongPolling transport) DELETE request sent."),[3,6];case 5:return this.logger.log(y.Trace,"(LongPolling transport) Stop finished."),this.raiseOnClose(),[7];case 6:return[2]}}))}))},t.prototype.raiseOnClose=function(){if(this.onclose){var t="(LongPolling transport) Firing onclose event.";this.closeError&&(t+=" Error: "+this.closeError),this.logger.log(y.Trace,t),this.onclose(this.closeError)}},t}(),G=function(t,e,n,o){return new(n||(n=Promise))((function(r,i){function s(t){try{c(o.next(t))}catch(e){i(e)}}function a(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){t.done?r(t.value):new n((function(e){e(t.value)})).then(s,a)}c((o=o.apply(t,e||[])).next())}))},V=function(t,e){var n,o,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,o=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!((r=(r=s.trys).length>0&&r[r.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){s.label=i[1];break}if(6===i[0]&&s.label<r[1]){s.label=r[1],r=i;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(i);break}r[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(a){i=[6,a],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},Z=function(){function t(t,e,n,o,r){this.httpClient=t,this.accessTokenFactory=e,this.logger=n,this.logMessageContent=o,this.eventSourceConstructor=r,this.onreceive=null,this.onclose=null}return t.prototype.connect=function(t,e){return G(this,void 0,void 0,(function(){var n,o=this;return V(this,(function(r){switch(r.label){case 0:return w.isRequired(t,"url"),w.isRequired(e,"transferFormat"),w.isIn(e,U,"transferFormat"),this.logger.log(y.Trace,"(SSE transport) Connecting."),this.url=t,this.accessTokenFactory?[4,this.accessTokenFactory()]:[3,2];case 1:(n=r.sent())&&(t+=(t.indexOf("?")<0?"?":"&")+"access_token="+encodeURIComponent(n)),r.label=2;case 2:return[2,new Promise((function(n,r){var i=!1;if(e===U.Text){var s;if("undefined"!=typeof window)s=new o.eventSourceConstructor(t,{withCredentials:!0});else{var a=o.httpClient.getCookieString(t);s=new o.eventSourceConstructor(t,{withCredentials:!0,headers:{Cookie:a}})}try{s.onmessage=function(t){if(o.onreceive)try{o.logger.log(y.Trace,"(SSE transport) data received. "+x(t.data,o.logMessageContent)+"."),o.onreceive(t.data)}catch(e){return void o.close(e)}},s.onerror=function(t){var e=new Error(t.data||"Error occurred");i?o.close(e):r(e)},s.onopen=function(){o.logger.log(y.Information,"SSE connected to "+o.url),o.eventSource=s,i=!0,n()}}catch(c){return void r(c)}}else r(new Error("The Server-Sent Events transport only supports the 'Text' transfer format"))}))]}}))}))},t.prototype.send=function(t){return G(this,void 0,void 0,(function(){return V(this,(function(e){return this.eventSource?[2,k(this.logger,"SSE",this.httpClient,this.url,this.accessTokenFactory,t,this.logMessageContent)]:[2,Promise.reject(new Error("Cannot send until the transport is connected"))]}))}))},t.prototype.stop=function(){return this.close(),Promise.resolve()},t.prototype.close=function(t){this.eventSource&&(this.eventSource.close(),this.eventSource=void 0,this.onclose&&this.onclose(t))},t}(),Q=function(){function t(t,e,n,o,r){this.logger=n,this.accessTokenFactory=e,this.logMessageContent=o,this.webSocketConstructor=r,this.httpClient=t,this.onreceive=null,this.onclose=null}return t.prototype.connect=function(t,e){return n=this,void 0,r=function(){var n,o=this;return function(t,e){var n,o,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,o=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!((r=(r=s.trys).length>0&&r[r.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){s.label=i[1];break}if(6===i[0]&&s.label<r[1]){s.label=r[1],r=i;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(i);break}r[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(a){i=[6,a],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}}(this,(function(r){switch(r.label){case 0:return w.isRequired(t,"url"),w.isRequired(e,"transferFormat"),w.isIn(e,U,"transferFormat"),this.logger.log(y.Trace,"(WebSockets transport) Connecting."),this.accessTokenFactory?[4,this.accessTokenFactory()]:[3,2];case 1:(n=r.sent())&&(t+=(t.indexOf("?")<0?"?":"&")+"access_token="+encodeURIComponent(n)),r.label=2;case 2:return[2,new Promise((function(n,r){var i;t=t.replace(/^http/,"ws");var s=o.httpClient.getCookieString(t);"undefined"==typeof window&&s&&(i=new o.webSocketConstructor(t,void 0,{headers:{Cookie:""+s}})),i||(i=new o.webSocketConstructor(t)),e===U.Binary&&(i.binaryType="arraybuffer"),i.onopen=function(e){o.logger.log(y.Information,"WebSocket connected to "+t+"."),o.webSocket=i,n()},i.onerror=function(t){var e=null;"undefined"!=typeof ErrorEvent&&t instanceof ErrorEvent&&(e=t.error),r(e)},i.onmessage=function(t){o.logger.log(y.Trace,"(WebSockets transport) data received. "+x(t.data,o.logMessageContent)+"."),o.onreceive&&o.onreceive(t.data)},i.onclose=function(t){return o.close(t)}}))]}}))},new((o=void 0)||(o=Promise))((function(t,e){function i(t){try{a(r.next(t))}catch(n){e(n)}}function s(t){try{a(r.throw(t))}catch(n){e(n)}}function a(e){e.done?t(e.value):new o((function(t){t(e.value)})).then(i,s)}a((r=r.apply(n,[])).next())}));var n,o,r},t.prototype.send=function(t){return this.webSocket&&this.webSocket.readyState===this.webSocketConstructor.OPEN?(this.logger.log(y.Trace,"(WebSockets transport) sending data. "+x(t,this.logMessageContent)+"."),this.webSocket.send(t),Promise.resolve()):Promise.reject("WebSocket is not in the OPEN state")},t.prototype.stop=function(){return this.webSocket&&(this.webSocket.onclose=function(){},this.webSocket.onmessage=function(){},this.webSocket.onerror=function(){},this.webSocket.close(),this.webSocket=void 0,this.close(void 0)),Promise.resolve()},t.prototype.close=function(t){this.logger.log(y.Trace,"(WebSockets transport) socket closed."),this.onclose&&(!t||!1!==t.wasClean&&1e3===t.code?this.onclose():this.onclose(new Error("WebSocket closed with status code: "+t.code+" ("+t.reason+").")))},t}(),Y=function(t,e,n,o){return new(n||(n=Promise))((function(r,i){function s(t){try{c(o.next(t))}catch(e){i(e)}}function a(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){t.done?r(t.value):new n((function(e){e(t.value)})).then(s,a)}c((o=o.apply(t,e||[])).next())}))},tt=function(t,e){var n,o,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,o=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!((r=(r=s.trys).length>0&&r[r.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){s.label=i[1];break}if(6===i[0]&&s.label<r[1]){s.label=r[1],r=i;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(i);break}r[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(a){i=[6,a],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},et=null,nt=null;if("undefined"==typeof window){var ot=require;et=ot("ws"),nt=ot("eventsource")}var rt=function(){function t(t,e){var n;void 0===e&&(e={}),this.features={},w.isRequired(t,"url"),this.logger=void 0===(n=e.logger)?new O(y.Information):null===n?m.instance:n.log?n:new O(n),this.baseUrl=this.resolveUrl(t),(e=e||{}).logMessageContent=e.logMessageContent||!1;var o="undefined"==typeof window;o||"undefined"==typeof WebSocket||e.WebSocket?o&&!e.WebSocket&&et&&(e.WebSocket=et):e.WebSocket=WebSocket,o||"undefined"==typeof EventSource||e.EventSource?o&&!e.EventSource&&void 0!==nt&&(e.EventSource=nt):e.EventSource=EventSource,this.httpClient=e.httpClient||new j(this.logger),this.connectionState=2,this.options=e,this.onreceive=null,this.onclose=null}return t.prototype.start=function(t){return w.isIn(t=t||U.Binary,U,"transferFormat"),this.logger.log(y.Debug,"Starting connection with transfer format '"+U[t]+"'."),2!==this.connectionState?Promise.reject(new Error("Cannot start a connection that is not in the 'Disconnected' state.")):(this.connectionState=0,this.startPromise=this.startInternal(t),this.startPromise)},t.prototype.send=function(t){if(1!==this.connectionState)throw new Error("Cannot send data if the connection is not in the 'Connected' State.");return this.transport.send(t)},t.prototype.stop=function(t){return Y(this,void 0,void 0,(function(){return tt(this,(function(e){switch(e.label){case 0:this.connectionState=2,this.stopError=t,e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.startPromise];case 2:case 3:return e.sent(),[3,4];case 4:return this.transport?[4,this.transport.stop()]:[3,6];case 5:e.sent(),this.transport=void 0,e.label=6;case 6:return[2]}}))}))},t.prototype.startInternal=function(t){return Y(this,void 0,void 0,(function(){var e,n,o,r,i,s,a,c=this;return tt(this,(function(l){switch(l.label){case 0:e=this.baseUrl,this.accessTokenFactory=this.options.accessTokenFactory,l.label=1;case 1:return l.trys.push([1,12,,13]),this.options.skipNegotiation?this.options.transport!==B.WebSockets?[3,3]:(this.transport=this.constructTransport(B.WebSockets),[4,this.transport.connect(e,t)]):[3,5];case 2:return l.sent(),[3,4];case 3:throw Error("Negotiation can only be skipped when using the WebSocket transport directly.");case 4:return[3,11];case 5:n=null,o=0,r=function(){var t;return tt(this,(function(r){switch(r.label){case 0:return[4,i.getNegotiationResponse(e)];case 1:if(n=r.sent(),2===i.connectionState)return[2,{value:void 0}];if(n.error)throw Error(n.error);if(n.ProtocolVersion)throw Error("Detected a connection attempt to an ASP.NET SignalR Server. This client only supports connecting to an ASP.NET Core SignalR Server. See https://aka.ms/signalr-core-differences for details.");return n.url&&(e=n.url),n.accessToken&&(t=n.accessToken,i.accessTokenFactory=function(){return t}),o++,[2]}}))},i=this,l.label=6;case 6:return[5,r()];case 7:if("object"==typeof(s=l.sent()))return[2,s.value];l.label=8;case 8:if(n.url&&o<100)return[3,6];l.label=9;case 9:if(100===o&&n.url)throw Error("Negotiate redirection limit exceeded.");return[4,this.createTransport(e,this.options.transport,n,t)];case 10:l.sent(),l.label=11;case 11:return this.transport instanceof K&&(this.features.inherentKeepAlive=!0),this.transport.onreceive=this.onreceive,this.transport.onclose=function(t){return c.stopConnection(t)},this.changeState(0,1),[3,13];case 12:throw a=l.sent(),this.logger.log(y.Error,"Failed to start the connection: "+a),this.connectionState=2,this.transport=void 0,a;case 13:return[2]}}))}))},t.prototype.getNegotiationResponse=function(t){return Y(this,void 0,void 0,(function(){var e,n,o,r,i,s;return tt(this,(function(a){switch(a.label){case 0:return this.accessTokenFactory?[4,this.accessTokenFactory()]:[3,2];case 1:(o=a.sent())&&((e={}).Authorization="Bearer "+o,n=e),a.label=2;case 2:r=this.resolveNegotiateUrl(t),this.logger.log(y.Debug,"Sending negotiation request: "+r+"."),a.label=3;case 3:return a.trys.push([3,5,,6]),[4,this.httpClient.post(r,{content:"",headers:n})];case 4:if(200!==(i=a.sent()).statusCode)throw Error("Unexpected status code returned from negotiate "+i.statusCode);return[2,JSON.parse(i.content)];case 5:throw s=a.sent(),this.logger.log(y.Error,"Failed to complete negotiation with the server: "+s),s;case 6:return[2]}}))}))},t.prototype.createConnectUrl=function(t,e){return e?t+(-1===t.indexOf("?")?"?":"&")+"id="+e:t},t.prototype.createTransport=function(t,e,n,o){return Y(this,void 0,void 0,(function(){var r,i,s,a,c,l;return tt(this,(function(u){switch(u.label){case 0:return r=this.createConnectUrl(t,n.connectionId),this.isITransport(e)?(this.logger.log(y.Debug,"Connection was provided an instance of ITransport, using that directly."),this.transport=e,[4,this.transport.connect(r,o)]):[3,2];case 1:return u.sent(),this.changeState(0,1),[2];case 2:i=0,s=n.availableTransports||[],u.label=3;case 3:return i<s.length?(a=s[i],this.connectionState=0,"number"!=typeof(c=this.resolveTransport(a,e,o))?[3,8]:(this.transport=this.constructTransport(c),n.connectionId?[3,5]:[4,this.getNegotiationResponse(t)])):[3,9];case 4:n=u.sent(),r=this.createConnectUrl(t,n.connectionId),u.label=5;case 5:return u.trys.push([5,7,,8]),[4,this.transport.connect(r,o)];case 6:return u.sent(),this.changeState(0,1),[2];case 7:return l=u.sent(),this.logger.log(y.Error,"Failed to start the transport '"+B[c]+"': "+l),this.connectionState=2,n.connectionId=void 0,[3,8];case 8:return i++,[3,3];case 9:throw new Error("Unable to initialize any of the available transports.")}}))}))},t.prototype.constructTransport=function(t){switch(t){case B.WebSockets:if(!this.options.WebSocket)throw new Error("'WebSocket' is not supported in your environment.");return new Q(this.httpClient,this.accessTokenFactory,this.logger,this.options.logMessageContent||!1,this.options.WebSocket);case B.ServerSentEvents:if(!this.options.EventSource)throw new Error("'EventSource' is not supported in your environment.");return new Z(this.httpClient,this.accessTokenFactory,this.logger,this.options.logMessageContent||!1,this.options.EventSource);case B.LongPolling:return new K(this.httpClient,this.accessTokenFactory,this.logger,this.options.logMessageContent||!1);default:throw new Error("Unknown transport: "+t+".")}},t.prototype.resolveTransport=function(t,e,n){var o=B[t.transport];if(null==o)this.logger.log(y.Debug,"Skipping transport '"+t.transport+"' because it is not supported by this client.");else{var r=t.transferFormats.map((function(t){return U[t]}));if(function(t,e){return!t||0!=(e&t)}(e,o))if(r.indexOf(n)>=0){if((o!==B.WebSockets||this.options.WebSocket)&&(o!==B.ServerSentEvents||this.options.EventSource))return this.logger.log(y.Debug,"Selecting transport '"+B[o]+"'."),o;this.logger.log(y.Debug,"Skipping transport '"+B[o]+"' because it is not supported in your environment.'")}else this.logger.log(y.Debug,"Skipping transport '"+B[o]+"' because it does not support the requested transfer format '"+U[n]+"'.");else this.logger.log(y.Debug,"Skipping transport '"+B[o]+"' because it was disabled by the client.")}return null},t.prototype.isITransport=function(t){return t&&"object"==typeof t&&"connect"in t},t.prototype.changeState=function(t,e){return this.connectionState===t&&(this.connectionState=e,!0)},t.prototype.stopConnection=function(t){this.transport=void 0,(t=this.stopError||t)?this.logger.log(y.Error,"Connection disconnected with error '"+t+"'."):this.logger.log(y.Information,"Connection disconnected."),this.connectionState=2,this.onclose&&this.onclose(t)},t.prototype.resolveUrl=function(t){if(0===t.lastIndexOf("https://",0)||0===t.lastIndexOf("http://",0))return t;if("undefined"==typeof window||!window||!window.document)throw new Error("Cannot resolve '"+t+"'.");var e=window.document.createElement("a");return e.href=t,this.logger.log(y.Information,"Normalizing '"+t+"' to '"+e.href+"'."),e.href},t.prototype.resolveNegotiateUrl=function(t){var e=t.indexOf("?"),n=t.substring(0,-1===e?t.length:e);return"/"!==n[n.length-1]&&(n+="/"),(n+="negotiate")+(-1===e?"":t.substring(e))},t}(),it=function(){function t(){this.name="json",this.version=1,this.transferFormat=U.Text}return t.prototype.parseMessages=function(t,e){if("string"!=typeof t)throw new Error("Invalid input for JSON hub protocol. Expected a string.");if(!t)return[];null===e&&(e=m.instance);for(var n=[],o=0,r=F.parse(t);o<r.length;o++){var i=JSON.parse(r[o]);if("number"!=typeof i.type)throw new Error("Invalid payload.");switch(i.type){case D.Invocation:this.isInvocationMessage(i);break;case D.StreamItem:this.isStreamItemMessage(i);break;case D.Completion:this.isCompletionMessage(i);break;case D.Ping:case D.Close:break;default:e.log(y.Information,"Unknown message type '"+i.type+"' ignored.");continue}n.push(i)}return n},t.prototype.writeMessage=function(t){return F.write(JSON.stringify(t))},t.prototype.isInvocationMessage=function(t){this.assertNotEmptyString(t.target,"Invalid payload for Invocation message."),void 0!==t.invocationId&&this.assertNotEmptyString(t.invocationId,"Invalid payload for Invocation message.")},t.prototype.isStreamItemMessage=function(t){if(this.assertNotEmptyString(t.invocationId,"Invalid payload for StreamItem message."),void 0===t.item)throw new Error("Invalid payload for StreamItem message.")},t.prototype.isCompletionMessage=function(t){if(t.result&&t.error)throw new Error("Invalid payload for Completion message.");!t.result&&t.error&&this.assertNotEmptyString(t.error,"Invalid payload for Completion message."),this.assertNotEmptyString(t.invocationId,"Invalid payload for Completion message.")},t.prototype.assertNotEmptyString=function(t,e){if("string"!=typeof t||""===t)throw new Error(e)},t}(),st=function(){function t(){}return t.prototype.configureLogging=function(t){return w.isRequired(t,"logging"),this.logger=void 0!==t.log?t:new O(t),this},t.prototype.withUrl=function(t,e){return w.isRequired(t,"url"),this.url=t,this.httpConnectionOptions="object"==typeof e?e:{transport:e},this},t.prototype.withHubProtocol=function(t){return w.isRequired(t,"protocol"),this.protocol=t,this},t.prototype.build=function(){var t=this.httpConnectionOptions||{};if(void 0===t.logger&&(t.logger=this.logger),!this.url)throw new Error("The 'HubConnectionBuilder.withUrl' method must be called before building the connection.");var e=new rt(this.url,t);return L.create(e,this.logger||m.instance,this.protocol||new it)},t}(),at=n("fXoL"),ct=n("BQIx"),lt=n("RyMC"),ut=n("rEr+"),ht=n("7zfz"),pt=n("I5S5"),ft=n("arFO");function dt(t,e){if(1&t&&(at.Pb(0,"span"),at.zc(1),at.Ob()),2&t){const t=e.$implicit;at.yb(1),at.Ac(t.label)}}function gt(t,e){if(1&t){const t=at.Qb();at.Pb(0,"tr"),at.Pb(1,"th",13),at.zc(2,"Placa "),at.Kb(3,"p-sortIcon",14),at.Ob(),at.Pb(4,"th",15),at.zc(5,"Cliente "),at.Kb(6,"p-sortIcon",16),at.Ob(),at.Pb(7,"th",17),at.zc(8,"Estado Ruta "),at.Kb(9,"p-sortIcon",18),at.Ob(),at.Ob(),at.Pb(10,"tr"),at.Pb(11,"th"),at.Pb(12,"input",19),at.Xb("input",(function(e){return at.rc(t),at.Zb(),at.pc(13).filter(e.target.value,"placa","contains")})),at.Ob(),at.Ob(),at.Pb(13,"th"),at.Pb(14,"input",20),at.Xb("input",(function(e){return at.rc(t),at.Zb(),at.pc(13).filter(e.target.value,"cliente","contains")})),at.Ob(),at.Ob(),at.Pb(15,"th"),at.Pb(16,"p-dropdown",21),at.Xb("onChange",(function(e){return at.rc(t),at.Zb(),at.pc(13).filter(e.value,"numeroEstado","equals")})),at.xc(17,dt,2,1,"ng-template",22),at.Ob(),at.Ob(),at.Ob()}if(2&t){const t=at.Zb();at.yb(16),at.fc("options",t.estadosRuta)("showClear",!0)}}function bt(t,e){if(1&t&&(at.Pb(0,"tr"),at.Pb(1,"td"),at.Pb(2,"span",23),at.zc(3,"Placa "),at.Ob(),at.zc(4),at.Ob(),at.Pb(5,"td"),at.Pb(6,"span",23),at.zc(7,"Cliente "),at.Ob(),at.zc(8),at.Ob(),at.Pb(9,"td"),at.Pb(10,"span",23),at.zc(11,"Estado Ruta "),at.Ob(),at.zc(12),at.Ob(),at.Ob()),2&t){const t=e.$implicit;at.yb(4),at.Ac(t.placa),at.yb(4),at.Ac(t.cliente),at.yb(4),at.Ac(0==t.numeroEstado?"Inicio":1==t.numeroEstado?"Transito":"Finalizado")}}function vt(t,e){if(1&t&&(at.Pb(0,"span"),at.zc(1),at.Ob()),2&t){const t=e.$implicit;at.yb(1),at.Ac(t.label)}}function yt(t,e){if(1&t){const t=at.Qb();at.Pb(0,"tr"),at.Pb(1,"th",13),at.zc(2,"Placa "),at.Kb(3,"p-sortIcon",14),at.Ob(),at.Pb(4,"th",15),at.zc(5,"Cliente "),at.Kb(6,"p-sortIcon",16),at.Ob(),at.Pb(7,"th",17),at.zc(8,"Estado Ruta "),at.Kb(9,"p-sortIcon",18),at.Ob(),at.Ob(),at.Pb(10,"tr"),at.Pb(11,"th"),at.Pb(12,"input",19),at.Xb("input",(function(e){return at.rc(t),at.Zb(),at.pc(20).filter(e.target.value,"placa","contains")})),at.Ob(),at.Ob(),at.Pb(13,"th"),at.Pb(14,"input",20),at.Xb("input",(function(e){return at.rc(t),at.Zb(),at.pc(20).filter(e.target.value,"cliente","contains")})),at.Ob(),at.Ob(),at.Pb(15,"th"),at.Pb(16,"p-dropdown",21),at.Xb("onChange",(function(e){return at.rc(t),at.Zb(),at.pc(20).filter(e.value,"numeroEstado","equals")})),at.xc(17,vt,2,1,"ng-template",22),at.Ob(),at.Ob(),at.Ob()}if(2&t){const t=at.Zb();at.yb(16),at.fc("options",t.estadosRuta)("showClear",!0)}}function mt(t,e){if(1&t&&(at.Pb(0,"tr"),at.Pb(1,"td"),at.Pb(2,"span",23),at.zc(3,"Placa "),at.Ob(),at.zc(4),at.Ob(),at.Pb(5,"td"),at.Pb(6,"span",23),at.zc(7,"Cliente "),at.Ob(),at.zc(8),at.Ob(),at.Pb(9,"td"),at.Pb(10,"span",23),at.zc(11,"Estado Ruta "),at.Ob(),at.zc(12),at.Ob(),at.Ob()),2&t){const t=e.$implicit;at.yb(4),at.Ac(t.placa),at.yb(4),at.Ac(t.cliente),at.yb(4),at.Ac(0==t.numeroEstado?"Inicio":1==t.numeroEstado?"Transito":"Finalizado")}}function wt(t,e){if(1&t){const t=at.Qb();at.Pb(0,"tr"),at.Pb(1,"th",15),at.zc(2,"Cliente "),at.Kb(3,"p-sortIcon",16),at.Ob(),at.Pb(4,"th",24),at.zc(5,"Numero Viajes "),at.Kb(6,"p-sortIcon",25),at.Ob(),at.Ob(),at.Pb(7,"tr"),at.Pb(8,"th"),at.Pb(9,"input",20),at.Xb("input",(function(e){return at.rc(t),at.Zb(),at.pc(27).filter(e.target.value,"cliente","contains")})),at.Ob(),at.Ob(),at.Pb(10,"th"),at.Pb(11,"input",26),at.Xb("input",(function(e){return at.rc(t),at.Zb(),at.pc(27).filter(e.target.value,"numeroViajes","contains")})),at.Ob(),at.Ob(),at.Ob()}}function xt(t,e){if(1&t&&(at.Pb(0,"tr"),at.Pb(1,"td"),at.Pb(2,"span",23),at.zc(3,"Cliente "),at.Ob(),at.zc(4),at.Ob(),at.Pb(5,"td"),at.Pb(6,"span",23),at.zc(7,"Numero Viajes "),at.Ob(),at.zc(8),at.Ob(),at.Ob()),2&t){const t=e.$implicit;at.yb(4),at.Ac(t.cliente),at.yb(4),at.Ac(t.numeroViajes)}}const St=function(){return[10,25,50]},kt=[{path:"",component:(()=>{class t extends u.a{constructor(t,e,n){super(t,null,null,e,n),this.getService=t,this.toastCtrl=e,this.modalCtrl=n,this.plugin=l.a,this.estadosRuta=[{label:"Inicio",value:"1"},{label:"Transito",value:"2"},{label:"Finalizado",value:"3"}],this.options={tooltips:{enabled:!1},plugins:{datalabels:{formatter:(t,e)=>{let n=e.chart.data.datasets;if(n.indexOf(e.dataset)===n.length-1){let e=n[0].data.reduce((t,e)=>t+e,0);return Math.round(t/e*100)+"% - "+t}return t},color:"#FFF"}}}}ngOnInit(){super.consumirGet("viajes/prueba").then(t=>{this.dashboard=t}),this.conectarWebSocket()}conectarWebSocket(){let t=(new st).withUrl("http://localhost:60674/contador",{skipNegotiation:!0,transport:B.WebSockets}).build();t.start().then(()=>{console.log("Connected"),t.on("dashboard",t=>{console.log("data:"),console.log(t),t.success&&(this.vehiculosPropios=t.message.lstVehiculosPropios,this.vehiculosTerceros=t.message.lstVehiculosTerceros,this.indicadores=t.message.lstIndicadores,this.data={labels:["Activos","Inactivos"],datasets:[{data:t.message.lstDatosTorta,backgroundColor:["#36A2EB","#FFCE56"],hoverBackgroundColor:["#496427","#a29fa0"]}]})})})}}return t.\u0275fac=function(e){return new(e||t)(at.Jb(ct.a),at.Jb(s.Q),at.Jb(s.J))},t.\u0275cmp=at.Db({type:t,selectors:[["app-dashboard"]],features:[at.vb],decls:35,vars:20,consts:[["slot","start"],[1,"dashboard-content"],[1,"vehiculos-propios-container"],["styleClass","p-datatable-striped p-datatable-responsive-demo","currentPageReportTemplate","Mostrando {first} a {last} de {totalRecords} registros",3,"value","paginator","rows","showCurrentPageReport","rowsPerPageOptions"],["dtPropios",""],["pTemplate","header"],["pTemplate","body"],[1,"vehiculos-terceros-container"],["dtTerceros",""],[1,"indicadores-container"],["dtIndicadores",""],[1,"ocupacion-flota-container"],["type","pie","width","50vh","height","50vh",3,"data","options"],["pSortableColumn","placa"],["field","placa"],["pSortableColumn","cliente"],["field","cliente"],["pSortableColumn","numeroEstado"],["field","numeroEstado"],["pInputText","","type","text","placeholder","Buscar por Placa",1,"p-column-filter",3,"input"],["pInputText","","type","text","placeholder","Buscar por Cliente",1,"p-column-filter",3,"input"],["styleClass","p-column-filter","placeholder","Buscar por Estado Ruta",3,"options","showClear","onChange"],["pTemplate","item"],[1,"p-column-title"],["pSortableColumn","numeroViajes"],["field","numeroViajes"],["pInputText","","type","text","placeholder","Buscar por Numero Viajes",1,"p-column-filter",3,"input"]],template:function(t,e){1&t&&(at.Pb(0,"ion-header"),at.Pb(1,"ion-toolbar"),at.Pb(2,"ion-buttons",0),at.Kb(3,"ion-menu-button"),at.Ob(),at.Pb(4,"ion-title"),at.zc(5," Dashboard "),at.Ob(),at.Ob(),at.Kb(6,"app-user-menu"),at.Ob(),at.Pb(7,"ion-content"),at.Pb(8,"div",1),at.Pb(9,"div",2),at.Pb(10,"ion-title"),at.zc(11," Vehiculos Propios "),at.Ob(),at.Pb(12,"p-table",3,4),at.xc(14,gt,18,2,"ng-template",5),at.xc(15,bt,13,3,"ng-template",6),at.Ob(),at.Ob(),at.Pb(16,"div",7),at.Pb(17,"ion-title"),at.zc(18," Vehiculos Terceros "),at.Ob(),at.Pb(19,"p-table",3,8),at.xc(21,yt,18,2,"ng-template",5),at.xc(22,mt,13,3,"ng-template",6),at.Ob(),at.Ob(),at.Pb(23,"div",9),at.Pb(24,"ion-title"),at.zc(25," Indicadores "),at.Ob(),at.Pb(26,"p-table",3,10),at.xc(28,wt,12,0,"ng-template",5),at.xc(29,xt,9,2,"ng-template",6),at.Ob(),at.Ob(),at.Pb(30,"div",11),at.Pb(31,"ion-title"),at.zc(32," Ocupaci\xf3n Flota Propia "),at.Ob(),at.Pb(33,"div"),at.Kb(34,"p-chart",12),at.Ob(),at.Ob(),at.Ob(),at.Ob()),2&t&&(at.yb(12),at.fc("value",e.vehiculosPropios)("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",at.hc(17,St)),at.yb(7),at.fc("value",e.vehiculosTerceros)("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",at.hc(18,St)),at.yb(7),at.fc("value",e.indicadores)("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",at.hc(19,St)),at.yb(8),at.fc("data",e.data)("options",e.options))},directives:[s.m,s.E,s.d,s.x,s.D,lt.a,s.g,ut.e,ht.b,pt.b,ut.d,ut.c,ft.a],styles:["[_nghost-%COMP%]     .p-datatable-responsive-demo .p-datatable-tbody>tr>td .p-column-title{display:none}.p-d-flex[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.action-column[_ngcontent-%COMP%]{text-align:center!important}.indicadores-container[_ngcontent-%COMP%], .ocupacion-flota-container[_ngcontent-%COMP%], .vehiculos-propios-container[_ngcontent-%COMP%], .vehiculos-terceros-container[_ngcontent-%COMP%]{width:50%}.ocupacion-flota-container[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:center}.dashboard-content[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:wrap}.dashboard-content[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{padding:10px}@media screen and (max-width:40rem){[_nghost-%COMP%]     .p-datatable.p-datatable-responsive-demo .p-datatable-tfoot>tr>td, [_nghost-%COMP%]     .p-datatable.p-datatable-responsive-demo .p-datatable-thead>tr>th{display:none!important}[_nghost-%COMP%]     .p-datatable.p-datatable-responsive-demo .p-datatable-tbody>tr>td{text-align:left;display:block;width:100%;float:left;clear:left;border:0}[_nghost-%COMP%]     .p-datatable.p-datatable-responsive-demo .p-datatable-tbody>tr>td .p-column-title{padding:.4rem;min-width:30%;display:inline-block;margin:-.4em 1em -.4em -.4rem;font-weight:700}[_nghost-%COMP%]     .p-datatable.p-datatable-responsive-demo .p-datatable-tbody>tr>td:last-child{border-bottom:1px solid var(--surface-d)}}"]}),t})()}];let Pt=(()=>{class t{}return t.\u0275mod=at.Hb({type:t}),t.\u0275inj=at.Gb({factory:function(e){return new(e||t)},imports:[[a.i.forChild(kt)],a.i]}),t})();var Ct=n("m/q5");let _t=(()=>{class t{}return t.\u0275mod=at.Hb({type:t}),t.\u0275inj=at.Gb({factory:function(e){return new(e||t)},imports:[[r.b,i.e,s.G,Pt,pt.a,ut.f,ft.b,Ct.a]]}),t})()},qb46:function(t,e,n){t.exports=function(t){"use strict";var e=(t=t&&t.hasOwnProperty("default")?t.default:t).helpers,n=function(){if("undefined"!=typeof window){if(window.devicePixelRatio)return window.devicePixelRatio;var t=window.screen;if(t)return(t.deviceXDPI||1)/(t.logicalXDPI||1)}return 1}(),o={toTextLines:function(t){var n,o=[];for(t=[].concat(t);t.length;)"string"==typeof(n=t.pop())?o.unshift.apply(o,n.split("\n")):Array.isArray(n)?t.push.apply(t,n):e.isNullOrUndef(t)||o.unshift(""+n);return o},toFontString:function(t){return!t||e.isNullOrUndef(t.size)||e.isNullOrUndef(t.family)?null:(t.style?t.style+" ":"")+(t.weight?t.weight+" ":"")+t.size+"px "+t.family},textSize:function(t,e,n){var o,r=[].concat(e),i=r.length,s=t.font,a=0;for(t.font=n.string,o=0;o<i;++o)a=Math.max(t.measureText(r[o]).width,a);return t.font=s,{height:i*n.lineHeight,width:a}},parseFont:function(n){var r=t.defaults.global,i=e.valueOrDefault(n.size,r.defaultFontSize),s={family:e.valueOrDefault(n.family,r.defaultFontFamily),lineHeight:e.options.toLineHeight(n.lineHeight,i),size:i,style:e.valueOrDefault(n.style,r.defaultFontStyle),weight:e.valueOrDefault(n.weight,null),string:""};return s.string=o.toFontString(s),s},bound:function(t,e,n){return Math.max(t,Math.min(e,n))},arrayDiff:function(t,e){var n,o,r,i,s=t.slice(),a=[];for(n=0,r=e.length;n<r;++n)-1===(o=s.indexOf(i=e[n]))?a.push([i,1]):s.splice(o,1);for(n=0,r=s.length;n<r;++n)a.push([s[n],-1]);return a},rasterize:function(t){return Math.round(t*n)/n}};function r(t,e){var n=e.x,o=e.y;if(null===n)return{x:0,y:-1};if(null===o)return{x:1,y:0};var r=t.x-n,i=t.y-o,s=Math.sqrt(r*r+i*i);return{x:s?r/s:0,y:s?i/s:-1}}function i(t,e,n){var o=0;return t<n.left?o|=1:t>n.right&&(o|=2),e<n.top?o|=8:e>n.bottom&&(o|=4),o}function s(t,e){var n,o,r=e.anchor,s=t;return e.clamp&&(s=function(t,e){for(var n,o,r,s=t.x0,a=t.y0,c=t.x1,l=t.y1,u=i(s,a,e),h=i(c,l,e);u|h&&!(u&h);)8&(n=u||h)?(o=s+(c-s)*(e.top-a)/(l-a),r=e.top):4&n?(o=s+(c-s)*(e.bottom-a)/(l-a),r=e.bottom):2&n?(r=a+(l-a)*(e.right-s)/(c-s),o=e.right):1&n&&(r=a+(l-a)*(e.left-s)/(c-s),o=e.left),n===u?u=i(s=o,a=r,e):h=i(c=o,l=r,e);return{x0:s,x1:c,y0:a,y1:l}}(s,e.area)),"start"===r?(n=s.x0,o=s.y0):"end"===r?(n=s.x1,o=s.y1):(n=(s.x0+s.x1)/2,o=(s.y0+s.y1)/2),function(t,e,n,o,r){switch(r){case"center":n=o=0;break;case"bottom":n=0,o=1;break;case"right":n=1,o=0;break;case"left":n=-1,o=0;break;case"top":n=0,o=-1;break;case"start":n=-n,o=-o;break;case"end":break;default:r*=Math.PI/180,n=Math.cos(r),o=Math.sin(r)}return{x:t,y:e,vx:n,vy:o}}(n,o,t.vx,t.vy,e.align)}var a={arc:function(t,e){var n=(t.startAngle+t.endAngle)/2,o=Math.cos(n),r=Math.sin(n),i=t.innerRadius,a=t.outerRadius;return s({x0:t.x+o*i,y0:t.y+r*i,x1:t.x+o*a,y1:t.y+r*a,vx:o,vy:r},e)},point:function(t,e){var n=r(t,e.origin),o=n.x*t.radius,i=n.y*t.radius;return s({x0:t.x-o,y0:t.y-i,x1:t.x+o,y1:t.y+i,vx:n.x,vy:n.y},e)},rect:function(t,e){var n=r(t,e.origin),o=t.x,i=t.y,a=0,c=0;return t.horizontal?(o=Math.min(t.x,t.base),a=Math.abs(t.base-t.x)):(i=Math.min(t.y,t.base),c=Math.abs(t.base-t.y)),s({x0:o,y0:i+c,x1:o+a,y1:i,vx:n.x,vy:n.y},e)},fallback:function(t,e){var n=r(t,e.origin);return s({x0:t.x,y0:t.y,x1:t.x,y1:t.y,vx:n.x,vy:n.y},e)}},c=t.helpers,l=o.rasterize;function u(t){var e=t._model.horizontal,n=t._scale||e&&t._xScale||t._yScale;if(!n)return null;if(void 0!==n.xCenter&&void 0!==n.yCenter)return{x:n.xCenter,y:n.yCenter};var o=n.getBasePixel();return e?{x:o,y:null}:{x:null,y:o}}function h(t,e,n){var o=t.shadowBlur,r=n.stroked,i=l(n.x),s=l(n.y),a=l(n.w);r&&t.strokeText(e,i,s,a),n.filled&&(o&&r&&(t.shadowBlur=0),t.fillText(e,i,s,a),o&&r&&(t.shadowBlur=o))}var p=function(t,e,n,o){var r=this;r._config=t,r._index=o,r._model=null,r._rects=null,r._ctx=e,r._el=n};c.extend(p.prototype,{_modelize:function(e,n,r,i){var s,l=this._index,h=c.options.resolve,p=o.parseFont(h([r.font,{}],i,l)),f=h([r.color,t.defaults.global.defaultFontColor],i,l);return{align:h([r.align,"center"],i,l),anchor:h([r.anchor,"center"],i,l),area:i.chart.chartArea,backgroundColor:h([r.backgroundColor,null],i,l),borderColor:h([r.borderColor,null],i,l),borderRadius:h([r.borderRadius,0],i,l),borderWidth:h([r.borderWidth,0],i,l),clamp:h([r.clamp,!1],i,l),clip:h([r.clip,!1],i,l),color:f,display:e,font:p,lines:n,offset:h([r.offset,0],i,l),opacity:h([r.opacity,1],i,l),origin:u(this._el),padding:c.options.toPadding(h([r.padding,0],i,l)),positioner:(s=this._el,s instanceof t.elements.Arc?a.arc:s instanceof t.elements.Point?a.point:s instanceof t.elements.Rectangle?a.rect:a.fallback),rotation:h([r.rotation,0],i,l)*(Math.PI/180),size:o.textSize(this._ctx,n,p),textAlign:h([r.textAlign,"start"],i,l),textShadowBlur:h([r.textShadowBlur,0],i,l),textShadowColor:h([r.textShadowColor,f],i,l),textStrokeColor:h([r.textStrokeColor,f],i,l),textStrokeWidth:h([r.textStrokeWidth,0],i,l)}},update:function(t){var e,n,r,i=this,s=null,a=null,l=i._index,u=i._config,h=c.options.resolve([u.display,!0],t,l);h&&(n=c.valueOrDefault(c.callback(u.formatter,[e=t.dataset.data[l],t]),e),(r=c.isNullOrUndef(n)?[]:o.toTextLines(n)).length&&(a=function(t){var e=t.borderWidth||0,n=t.padding,o=t.size.height,r=t.size.width,i=-r/2,s=-o/2;return{frame:{x:i-n.left-e,y:s-n.top-e,w:r+n.width+2*e,h:o+n.height+2*e},text:{x:i,y:s,w:r,h:o}}}(s=i._modelize(h,r,u,t)))),i._model=s,i._rects=a},geometry:function(){return this._rects?this._rects.frame:{}},rotation:function(){return this._model?this._model.rotation:0},visible:function(){return this._model&&this._model.opacity},model:function(){return this._model},draw:function(t,e){var n,r=t.ctx,i=this._model,s=this._rects;this.visible()&&(r.save(),i.clip&&(n=i.area,r.beginPath(),r.rect(n.left,n.top,n.right-n.left,n.bottom-n.top),r.clip()),r.globalAlpha=o.bound(0,i.opacity,1),r.translate(l(e.x),l(e.y)),r.rotate(i.rotation),function(t,e,n){var o=n.backgroundColor,r=n.borderColor,i=n.borderWidth;(o||r&&i)&&(t.beginPath(),c.canvas.roundedRect(t,l(e.x)+i/2,l(e.y)+i/2,l(e.w)-i,l(e.h)-i,n.borderRadius),t.closePath(),o&&(t.fillStyle=o,t.fill()),r&&i&&(t.strokeStyle=r,t.lineWidth=i,t.lineJoin="miter",t.stroke()))}(r,s.frame,i),function(t,e,n,o){var r,i=o.textAlign,s=o.color,a=!!s,c=o.font,l=e.length,u=o.textStrokeColor,p=o.textStrokeWidth,f=u&&p;if(l&&(a||f))for(n=function(t,e,n){var o=n.lineHeight,r=t.w,i=t.x;return"center"===e?i+=r/2:"end"!==e&&"right"!==e||(i+=r),{h:o,w:r,x:i,y:t.y+o/2}}(n,i,c),t.font=c.string,t.textAlign=i,t.textBaseline="middle",t.shadowBlur=o.textShadowBlur,t.shadowColor=o.textShadowColor,a&&(t.fillStyle=s),f&&(t.lineJoin="round",t.lineWidth=p,t.strokeStyle=u),r=0,l=e.length;r<l;++r)h(t,e[r],{stroked:f,filled:a,w:n.w,x:n.x,y:n.y+n.h*r})}(r,i.lines,s.text,i),r.restore())}});var f=Number.MIN_SAFE_INTEGER||-9007199254740991,d=Number.MAX_SAFE_INTEGER||9007199254740991;function g(t,e,n){var o=Math.cos(n),r=Math.sin(n),i=e.x,s=e.y;return{x:i+o*(t.x-i)-r*(t.y-s),y:s+r*(t.x-i)+o*(t.y-s)}}function b(t,e){var n,o,r,i=d,s=f,a=e.origin;for(n=0;n<t.length;++n)r=e.vx*((o=t[n]).x-a.x)+e.vy*(o.y-a.y),i=Math.min(i,r),s=Math.max(s,r);return{min:i,max:s}}function v(t,e){var n=e.x-t.x,o=e.y-t.y,r=Math.sqrt(n*n+o*o);return{vx:(e.x-t.x)/r,vy:(e.y-t.y)/r,origin:t,ln:r}}var y=function(){this._rotation=0,this._rect={x:0,y:0,w:0,h:0}};function m(t,e,n){var o=e.positioner(t,e),r=o.vx,i=o.vy;if(!r&&!i)return{x:o.x,y:o.y};var s=n.w,a=n.h,c=e.rotation,l=Math.abs(s/2*Math.cos(c))+Math.abs(a/2*Math.sin(c)),u=Math.abs(s/2*Math.sin(c))+Math.abs(a/2*Math.cos(c)),h=1/Math.max(Math.abs(r),Math.abs(i));return l*=r*h,u*=i*h,{x:o.x+(l+=e.offset*r),y:o.y+(u+=e.offset*i)}}t.helpers.extend(y.prototype,{center:function(){var t=this._rect;return{x:t.x+t.w/2,y:t.y+t.h/2}},update:function(t,e,n){this._rotation=n,this._rect={x:e.x+t.x,y:e.y+t.y,w:e.w,h:e.h}},contains:function(t){var e=this._rect;return!((t=g(t,this.center(),-this._rotation)).x<e.x-1||t.y<e.y-1||t.x>e.x+e.w+2||t.y>e.y+e.h+2)},intersects:function(t){var e,n,o,r=this._points(),i=t._points(),s=[v(r[0],r[1]),v(r[0],r[3])];for(this._rotation!==t._rotation&&s.push(v(i[0],i[1]),v(i[0],i[3])),e=0;e<s.length;++e)if(n=b(r,s[e]),o=b(i,s[e]),n.max<o.min||o.max<n.min)return!1;return!0},_points:function(){var t=this._rect,e=this._rotation,n=this.center();return[g({x:t.x,y:t.y},n,e),g({x:t.x+t.w,y:t.y},n,e),g({x:t.x+t.w,y:t.y+t.h},n,e),g({x:t.x,y:t.y+t.h},n,e)]}});var w={prepare:function(t){var e,n,o,r,i,s=[];for(e=0,o=t.length;e<o;++e)for(n=0,r=t[e].length;n<r;++n)s.push(i=t[e][n]),i.$layout={_box:new y,_hidable:!1,_visible:!0,_set:e,_idx:n};return s.sort((function(t,e){var n=t.$layout,o=e.$layout;return n._idx===o._idx?o._set-n._set:o._idx-n._idx})),this.update(s),s},update:function(t){var e,n,o,r,i,s=!1;for(e=0,n=t.length;e<n;++e)r=(o=t[e]).model(),(i=o.$layout)._hidable=r&&"auto"===r.display,i._visible=o.visible(),s|=i._hidable;s&&function(t){var e,n,o,r,i,s;for(e=0,n=t.length;e<n;++e)(r=(o=t[e]).$layout)._visible&&(i=o.geometry(),s=m(o._el._model,o.model(),i),r._box.update(s,i,o.rotation()));!function(t,e){var n,o,r,i;for(n=t.length-1;n>=0;--n)for(r=t[n].$layout,o=n-1;o>=0&&r._visible;--o)(i=t[o].$layout)._visible&&r._box.intersects(i._box)&&e(r,i)}(t,(function(t,e){var n=t._hidable,o=e._hidable;n&&o||o?e._visible=!1:n&&(t._visible=!1)}))}(t)},lookup:function(t,e){var n,o;for(n=t.length-1;n>=0;--n)if((o=t[n].$layout)&&o._visible&&o._box.contains(e))return t[n];return null},draw:function(t,e){var n,o,r,i,s,a;for(n=0,o=e.length;n<o;++n)(i=(r=e[n]).$layout)._visible&&(s=r.geometry(),a=m(r._el._view,r.model(),s),i._box.update(a,s,r.rotation()),r.draw(t,a))}},x=t.helpers,S=t.helpers;function k(t,e,n){if(e){var o,r=n.$context,i=n.$groups;e[i._set]&&(o=e[i._set][i._key])&&!0===S.callback(o,[r])&&(t.$datalabels._dirty=!0,n.update(r))}}t.defaults.global.plugins.datalabels={align:"center",anchor:"center",backgroundColor:null,borderColor:null,borderRadius:0,borderWidth:0,clamp:!1,clip:!1,color:void 0,display:!0,font:{family:void 0,lineHeight:1.2,size:void 0,style:void 0,weight:null},formatter:function(t){if(x.isNullOrUndef(t))return null;var e,n,o,r=t;if(x.isObject(t))if(x.isNullOrUndef(t.label))if(x.isNullOrUndef(t.r))for(r="",o=0,n=(e=Object.keys(t)).length;o<n;++o)r+=(0!==o?", ":"")+e[o]+": "+t[e[o]];else r=t.r;else r=t.label;return""+r},labels:void 0,listeners:{},offset:4,opacity:1,padding:{top:4,right:4,bottom:4,left:4},rotation:0,textAlign:"start",textStrokeColor:void 0,textStrokeWidth:0,textShadowBlur:0,textShadowColor:void 0};var P={id:"datalabels",beforeInit:function(t){t.$datalabels={_actives:[]}},beforeUpdate:function(t){var e=t.$datalabels;e._listened=!1,e._listeners={},e._datasets=[],e._labels=[]},afterDatasetUpdate:function(t,e,n){var o,r,i,s,a,c,l,u,h=e.index,f=t.$datalabels,d=f._datasets[h]=[],g=t.isDatasetVisible(h),b=t.data.datasets[h],v=function(t,e){var n,o,r=t.datalabels,i={},s=[];return!1===r?null:(!0===r&&(r={}),e=S.merge({},[e,r]),n=e.labels||{},o=Object.keys(n),delete e.labels,o.length?o.forEach((function(t){n[t]&&s.push(S.merge({},[e,n[t],{_key:t}]))})):s.push(e),i=s.reduce((function(t,e){return S.each(e.listeners||{},(function(n,o){t[o]=t[o]||{},t[o][e._key||"$default"]=n})),delete e.listeners,t}),{}),{labels:s,listeners:i})}(b,n),y=e.meta.data||[],m=t.ctx;for(m.save(),o=0,i=y.length;o<i;++o)if((l=y[o]).$datalabels=[],g&&l&&!l.hidden&&!l._model.skip)for(r=0,s=v.labels.length;r<s;++r)c=(a=v.labels[r])._key,(u=new p(a,m,l,o)).$groups={_set:h,_key:c||"$default"},u.$context={active:!1,chart:t,dataIndex:o,dataset:b,datasetIndex:h},u.update(u.$context),l.$datalabels.push(u),d.push(u);m.restore(),S.merge(f._listeners,v.listeners,{merger:function(t,n,o){n[t]=n[t]||{},n[t][e.index]=o[t],f._listened=!0}})},afterUpdate:function(t,e){t.$datalabels._labels=w.prepare(t.$datalabels._datasets,e)},afterDatasetsDraw:function(t){w.draw(t,t.$datalabels._labels)},beforeEvent:function(t,e){if(t.$datalabels._listened)switch(e.type){case"mousemove":case"mouseout":!function(t,e){var n,o,r=t.$datalabels,i=r._listeners;if(i.enter||i.leave){if("mousemove"===e.type)o=w.lookup(r._labels,e);else if("mouseout"!==e.type)return;n=r._hovered,r._hovered=o,function(t,e,n,o){var r,i;(n||o)&&(n?o?n!==o&&(i=r=!0):i=!0:r=!0,i&&k(t,e.leave,n),r&&k(t,e.enter,o))}(t,i,n,o)}}(t,e);break;case"click":!function(t,e){var n=t.$datalabels,o=n._listeners.click,r=o&&w.lookup(n._labels,e);r&&k(t,o,r)}(t,e)}},afterEvent:function(e){var n,r,i,s,a,c,l,u=e.$datalabels,h=u._actives,p=u._actives=e.lastActive||[],f=o.arrayDiff(h,p);for(n=0,r=f.length;n<r;++n)if((a=f[n])[1])for(i=0,s=(l=a[0].$datalabels||[]).length;i<s;++i)(c=l[i]).$context.active=1===a[1],c.update(c.$context);(u._dirty||f.length)&&(w.update(u._labels),function(e){if(!e.animating){for(var n=t.animationService.animations,o=0,r=n.length;o<r;++o)if(n[o].chart===e)return;e.render({duration:1,lazy:!0})}}(e)),delete u._dirty}};return t.plugins.register(P),P}(n("MO+k"))}}]);